# 대화 시스템 (Chat System)

## 개요
Knock 서비스의 핵심 인터랙션 시스템으로, 사용자가 AI 페르소나(룸메이트, 이웃)와 1:1 실시간 대화를 나누는 기능입니다. LLM API(Gemini)를 활용하여 각 AI의 시스템 프롬프트에 기반한 개인화된 응답을 생성하며, 세션 기반 메모리를 통해 대화의 맥락을 유지합니다.

## 핵심 가치
- **실시간 응답**: LLM 기반 자연스러운 대화 흐름
- **페르소나 일관성**: 시스템 프롬프트에 충실한 AI 캐릭터 유지
- **접근 편의성**: 방 블록 클릭 → 즉시 채팅 모달 실행
- **확장 가능성**: 세션 메모리 → 영구 메모리 업그레이드 경로

## 주요 기능

### 1. 1:1 채팅 모달
- 방 블록 클릭 시 모달 오픈
- 실시간 메시지 송수신
- 타이핑 인디케이터
- 스크롤 자동 하단 이동

### 2. LLM 기반 응답 생성
- Gemini API 실시간 호출
- 시스템 프롬프트 적용
- 세션 대화 히스토리 컨텍스트 포함

### 3. 세션 단위 메모리 (기본)
- 채팅 모달 오픈 동안만 대화 기억
- 모달 닫으면 휘발
- 서버 메모리 또는 Redis 임시 저장

### 4. 대화 기록 저장 (선택)
- 영구 메모리 (유료 기능)
- 과거 대화 요약 및 핵심 사실 기억
- 관계 동적 변화 (대화 빈도/주제 기반)

## 문서 구성

- [기능 명세서](./feature-spec.md) - 상세 기능 정의 및 요구사항
- [사용자 플로우](./user-flow.md) - 대화 시작부터 종료까지 여정
- [기술 스펙](./tech-spec.md) - API, 데이터베이스, LLM 통합 명세

## 의존성

### 선행 요구사항
- [룸메이트 시스템](../02_Roommate/README.md) - AI 페르소나 (시스템 프롬프트)
- [노크 시스템](../03_Knock/README.md) - 이웃 페르소나 (시스템 프롬프트)

### 연관 시스템
- [메모리 시스템](../06_Memory/README.md) - 대화 요약 및 영구 기억 (선택 기능)
- [관계 동적 변화](../07_Dynamics/README.md) - 대화 기반 프롬프트 업데이트 (선택 기능)

## 성공 지표 (KPI)
- 평균 대화 세션 길이
- 메시지당 평균 응답 시간
- 대화 재시작률 (재방문 사용자)
- 유료 전환율 (영구 메모리 구독)
- 사용자 만족도 (응답 품질)
